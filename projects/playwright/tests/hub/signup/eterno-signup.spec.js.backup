const { test, expect } = require('@playwright/test');
const config = require('../../../config/test-config');
const { loginAndHandleCookies } = require('../../../utils/auth-helper');

// ë¬´ì‘ìœ„ ê³„ì •ëª… ìƒì„± í•¨ìˆ˜
function generateRandomAccountName() {
  const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
  let result = '';
  for (let i = 0; i < 8; i++) {
    result += chars.charAt(Math.floor(Math.random() * chars.length));
  }
  return `TestAccount_${result}`;
}

// ê¸ˆì¹™ì–´ ëª©ë¡
const PROFANITY_WORDS = [
  'admin', 'administrator', 'root', 'system', 'test', 'user', 'guest',
  'fuck', 'shit', 'damn', 'hell', 'bitch', 'ass', 'crap',
  'hate', 'kill', 'die', 'death', 'murder', 'violence'
];

// ê¸ˆì¹™ì–´ í™•ì¸ í•¨ìˆ˜
function checkProfanity(username) {
  const lowerUsername = username.toLowerCase();
  return PROFANITY_WORDS.some(word => lowerUsername.includes(word));
}

// ìƒë…„ì›”ì¼ ìƒì„± í•¨ìˆ˜ (13ì„¸ ë¯¸ë§Œ/ì´ìƒ)
function generateBirthDate(isUnder13 = false) {
  const currentYear = new Date().getFullYear();
  const targetAge = isUnder13 ? Math.floor(Math.random() * 12) + 1 : Math.floor(Math.random() * 50) + 13;
  const birthYear = currentYear - targetAge;
  const birthMonth = Math.floor(Math.random() * 12) + 1;
  const birthDay = Math.floor(Math.random() * 28) + 1; // ì•ˆì „í•œ ë‚ ì§œ
  
  return {
    year: birthYear,
    month: birthMonth,
    day: birthDay,
    age: targetAge
  };
}

test.describe('Eterno Studio íšŒì›ê°€ì… ìë™í™”', () => {
  test('1ë‹¨ê³„: íšŒì›ê°€ì… í˜ì´ì§€ ì ‘ì†', async ({ page }) => {
    test.setTimeout(60000);
    
    console.log('ğŸ” 1ë‹¨ê³„: íšŒì›ê°€ì… í˜ì´ì§€ ì ‘ì† ì‹œì‘...');
    
    // í™ˆí˜ì´ì§€ ë°©ë¬¸
    await page.goto('https://eterno-qa.ovdr.io');
    await page.waitForLoadState('networkidle');
    
    // ì¿ í‚¤ ë™ì˜
    try {
      const cookieAcceptButton = page.locator('button:has-text("Accept All")');
      if (await cookieAcceptButton.count() > 0) {
        await cookieAcceptButton.click();
        console.log('ğŸª ì¿ í‚¤ ë™ì˜ ì™„ë£Œ');
      }
    } catch (error) {
      console.log('ğŸª ì¿ í‚¤ ë™ì˜ ë²„íŠ¼ì´ ì—†ìŒ');
    }
    
    // Sign up ë²„íŠ¼ í´ë¦­
    console.log('Sign up ë²„íŠ¼ í´ë¦­...');
    const signUpButton = page.locator('a:has-text("Sign up")');
    await expect(signUpButton).toBeVisible({ timeout: 10000 });
    await signUpButton.click();
    
    // íšŒì›ê°€ì… í˜ì´ì§€ ë¡œë”© ëŒ€ê¸°
    await page.waitForLoadState('networkidle');
    await page.waitForTimeout(2000);
    
    // URL í™•ì¸
    const signupUrl = page.url();
    console.log('íšŒì›ê°€ì… í˜ì´ì§€ URL:', signupUrl);
    
    console.log('âœ… 1ë‹¨ê³„ ì™„ë£Œ: íšŒì›ê°€ì… í˜ì´ì§€ ì ‘ì†');
  });
  
  test('2ë‹¨ê³„: ê³„ì •ëª… ì…ë ¥ ë° ê¸ˆì¹™ì–´ í™•ì¸', async ({ page }) => {
    test.setTimeout(60000);
    
    console.log('ğŸ“ 2ë‹¨ê³„: ê³„ì •ëª… ì…ë ¥ ë° ê¸ˆì¹™ì–´ í™•ì¸ ì‹œì‘...');
    
    // í™ˆí˜ì´ì§€ ë°©ë¬¸ ë° íšŒì›ê°€ì… í˜ì´ì§€ë¡œ ì´ë™
    await page.goto('https://eterno-qa.ovdr.io');
    await page.waitForLoadState('networkidle');
    
    // ì¿ í‚¤ ë™ì˜
    try {
      const cookieAcceptButton = page.locator('button:has-text("Accept All")');
      if (await cookieAcceptButton.count() > 0) {
        await cookieAcceptButton.click();
        console.log('ğŸª ì¿ í‚¤ ë™ì˜ ì™„ë£Œ');
      }
    } catch (error) {
      console.log('ğŸª ì¿ í‚¤ ë™ì˜ ë²„íŠ¼ì´ ì—†ìŒ');
    }
    
    // Sign up ë²„íŠ¼ í´ë¦­
    const signUpButton = page.locator('a:has-text("Sign up")');
    await expect(signUpButton).toBeVisible({ timeout: 10000 });
    await signUpButton.click();
    await page.waitForLoadState('networkidle');
    await page.waitForTimeout(2000);
    
    // ìœ íš¨í•œ ê³„ì •ëª… ìƒì„± ë° ì…ë ¥
    const validAccountName = generateRandomAccountName();
    console.log(`ìƒì„±ëœ ìœ íš¨í•œ ê³„ì •ëª…: ${validAccountName}`);
    
    // ê³„ì •ëª… ì…ë ¥ í•„ë“œ ì°¾ê¸° ë° ì…ë ¥
    const usernameField = page.locator('input[type="text"], input[placeholder*="username"], input[placeholder*="account"], input[name*="username"]').first();
    await expect(usernameField).toBeVisible({ timeout: 10000 });
    await usernameField.fill(validAccountName);
    console.log(`ìœ íš¨í•œ ê³„ì •ëª… ì…ë ¥ ì™„ë£Œ: ${validAccountName}`);
    
    // ê¸ˆì¹™ì–´ í…ŒìŠ¤íŠ¸
    console.log('ê¸ˆì¹™ì–´ í…ŒìŠ¤íŠ¸ ì‹œì‘...');
    const profanityAccountName = 'admin_test';
    console.log(`ê¸ˆì¹™ì–´ ê³„ì •ëª… í…ŒìŠ¤íŠ¸: ${profanityAccountName}`);
    
    // ê³„ì •ëª… í•„ë“œ í´ë¦¬ì–´ í›„ ê¸ˆì¹™ì–´ ì…ë ¥
    await usernameField.clear();
    await usernameField.fill(profanityAccountName);
    
    // ê¸ˆì¹™ì–´ ì—ëŸ¬ ë©”ì‹œì§€ í™•ì¸
    try {
      await page.waitForTimeout(2000); // ì—ëŸ¬ ë©”ì‹œì§€ ë¡œë”© ëŒ€ê¸°
      const errorMessage = page.locator('text=/ê¸ˆì¹™ì–´|profanity|invalid|not allowed/i');
      if (await errorMessage.count() > 0) {
        console.log('âœ… ê¸ˆì¹™ì–´ ê°ì§€ ê¸°ëŠ¥ í™•ì¸ë¨');
      } else {
        console.log('âš ï¸ ê¸ˆì¹™ì–´ ê°ì§€ ê¸°ëŠ¥ì´ ì‘ë™í•˜ì§€ ì•Šì„ ìˆ˜ ìˆìŒ');
      }
    } catch (error) {
      console.log('ê¸ˆì¹™ì–´ ì—ëŸ¬ ë©”ì‹œì§€ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ');
    }
    
    // ë‹¤ì‹œ ìœ íš¨í•œ ê³„ì •ëª…ìœ¼ë¡œ ë³€ê²½
    await usernameField.clear();
    await usernameField.fill(validAccountName);
    console.log('ìœ íš¨í•œ ê³„ì •ëª…ìœ¼ë¡œ ë³µêµ¬ ì™„ë£Œ');
    
    console.log('âœ… 2ë‹¨ê³„ ì™„ë£Œ: ê³„ì •ëª… ì…ë ¥ ë° ê¸ˆì¹™ì–´ í™•ì¸');
  });
  
  test('3ë‹¨ê³„: ìƒë…„ì›”ì¼ ì…ë ¥ (13ì„¸ ì´ìƒ)', async ({ page }) => {
    test.setTimeout(60000);
    
    console.log('ğŸ“… 3ë‹¨ê³„: ìƒë…„ì›”ì¼ ì…ë ¥ (13ì„¸ ì´ìƒ) ì‹œì‘...');
    
    // í™ˆí˜ì´ì§€ ë°©ë¬¸ ë° íšŒì›ê°€ì… í˜ì´ì§€ë¡œ ì´ë™
    await page.goto('https://eterno-qa.ovdr.io');
    await page.waitForLoadState('networkidle');
    
    // ì¿ í‚¤ ë™ì˜
    try {
      const cookieAcceptButton = page.locator('button:has-text("Accept All")');
      if (await cookieAcceptButton.count() > 0) {
        await cookieAcceptButton.click();
        console.log('ğŸª ì¿ í‚¤ ë™ì˜ ì™„ë£Œ');
      }
    } catch (error) {
      console.log('ğŸª ì¿ í‚¤ ë™ì˜ ë²„íŠ¼ì´ ì—†ìŒ');
    }
    
    // Sign up ë²„íŠ¼ í´ë¦­
    const signUpButton = page.locator('a:has-text("Sign up")');
    await expect(signUpButton).toBeVisible({ timeout: 10000 });
    await signUpButton.click();
    await page.waitForLoadState('networkidle');
    await page.waitForTimeout(2000);
    
    // ê³„ì •ëª… ì…ë ¥
    const validAccountName = generateRandomAccountName();
    const usernameField = page.locator('input[type="text"], input[placeholder*="username"], input[placeholder*="account"], input[name*="username"]').first();
    await expect(usernameField).toBeVisible({ timeout: 10000 });
    await usernameField.fill(validAccountName);
    
    // 13ì„¸ ì´ìƒ ìƒë…„ì›”ì¼ ìƒì„±
    const birthDate = generateBirthDate(false); // 13ì„¸ ì´ìƒ
    console.log(`ìƒì„±ëœ ìƒë…„ì›”ì¼ (13ì„¸ ì´ìƒ): ${birthDate.year}ë…„ ${birthDate.month}ì›” ${birthDate.day}ì¼ (${birthDate.age}ì„¸)`);
    
    // ìƒë…„ì›”ì¼ ë“œë¡­ë‹¤ìš´ ì°¾ê¸° ë° ì„ íƒ
    try {
      // ë…„ë„ ë“œë¡­ë‹¤ìš´
      const yearDropdown = page.locator('select[name*="year"], select[id*="year"], .year-select, [data-testid*="year"]').first();
      if (await yearDropdown.count() > 0) {
        await yearDropdown.selectOption({ value: birthDate.year.toString() });
        console.log(`ë…„ë„ ì„ íƒ ì™„ë£Œ: ${birthDate.year}`);
      } else {
        console.log('ë…„ë„ ë“œë¡­ë‹¤ìš´ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ');
      }
      
      // ì›” ë“œë¡­ë‹¤ìš´
      const monthDropdown = page.locator('select[name*="month"], select[id*="month"], .month-select, [data-testid*="month"]').first();
      if (await monthDropdown.count() > 0) {
        await monthDropdown.selectOption({ value: birthDate.month.toString() });
        console.log(`ì›” ì„ íƒ ì™„ë£Œ: ${birthDate.month}`);
      } else {
        console.log('ì›” ë“œë¡­ë‹¤ìš´ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ');
      }
      
      // ì¼ ë“œë¡­ë‹¤ìš´
      const dayDropdown = page.locator('select[name*="day"], select[id*="day"], .day-select, [data-testid*="day"]').first();
      if (await dayDropdown.count() > 0) {
        await dayDropdown.selectOption({ value: birthDate.day.toString() });
        console.log(`ì¼ ì„ íƒ ì™„ë£Œ: ${birthDate.day}`);
      } else {
        console.log('ì¼ ë“œë¡­ë‹¤ìš´ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ');
      }
      
    } catch (error) {
      console.log('ìƒë…„ì›”ì¼ ë“œë¡­ë‹¤ìš´ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜:', error.message);
    }
    
    console.log('âœ… 3ë‹¨ê³„ ì™„ë£Œ: ìƒë…„ì›”ì¼ ì…ë ¥ (13ì„¸ ì´ìƒ)');
  });
  
  test('4ë‹¨ê³„: ìƒë…„ì›”ì¼ ì…ë ¥ (13ì„¸ ë¯¸ë§Œ)', async ({ page }) => {
    test.setTimeout(60000);
    
    console.log('ğŸ“… 4ë‹¨ê³„: ìƒë…„ì›”ì¼ ì…ë ¥ (13ì„¸ ë¯¸ë§Œ) ì‹œì‘...');
    
    // í™ˆí˜ì´ì§€ ë°©ë¬¸ ë° íšŒì›ê°€ì… í˜ì´ì§€ë¡œ ì´ë™
    await page.goto('https://eterno-qa.ovdr.io');
    await page.waitForLoadState('networkidle');
    
    // ì¿ í‚¤ ë™ì˜
    try {
      const cookieAcceptButton = page.locator('button:has-text("Accept All")');
      if (await cookieAcceptButton.count() > 0) {
        await cookieAcceptButton.click();
        console.log('ğŸª ì¿ í‚¤ ë™ì˜ ì™„ë£Œ');
      }
    } catch (error) {
      console.log('ğŸª ì¿ í‚¤ ë™ì˜ ë²„íŠ¼ì´ ì—†ìŒ');
    }
    
    // Sign up ë²„íŠ¼ í´ë¦­
    const signUpButton = page.locator('a:has-text("Sign up")');
    await expect(signUpButton).toBeVisible({ timeout: 10000 });
    await signUpButton.click();
    await page.waitForLoadState('networkidle');
    await page.waitForTimeout(2000);
    
    // ê³„ì •ëª… ì…ë ¥
    const validAccountName = generateRandomAccountName();
    const usernameField = page.locator('input[type="text"], input[placeholder*="username"], input[placeholder*="account"], input[name*="username"]').first();
    await expect(usernameField).toBeVisible({ timeout: 10000 });
    await usernameField.fill(validAccountName);
    
    // 13ì„¸ ë¯¸ë§Œ ìƒë…„ì›”ì¼ ìƒì„±
    const birthDate = generateBirthDate(true); // 13ì„¸ ë¯¸ë§Œ
    console.log(`ìƒì„±ëœ ìƒë…„ì›”ì¼ (13ì„¸ ë¯¸ë§Œ): ${birthDate.year}ë…„ ${birthDate.month}ì›” ${birthDate.day}ì¼ (${birthDate.age}ì„¸)`);
    
    // ìƒë…„ì›”ì¼ ë“œë¡­ë‹¤ìš´ ì°¾ê¸° ë° ì„ íƒ
    try {
      // ë…„ë„ ë“œë¡­ë‹¤ìš´
      const yearDropdown = page.locator('select[name*="year"], select[id*="year"], .year-select, [data-testid*="year"]').first();
      if (await yearDropdown.count() > 0) {
        await yearDropdown.selectOption({ value: birthDate.year.toString() });
        console.log(`ë…„ë„ ì„ íƒ ì™„ë£Œ: ${birthDate.year}`);
      }
      
      // ì›” ë“œë¡­ë‹¤ìš´
      const monthDropdown = page.locator('select[name*="month"], select[id*="month"], .month-select, [data-testid*="month"]').first();
      if (await monthDropdown.count() > 0) {
        await monthDropdown.selectOption({ value: birthDate.month.toString() });
        console.log(`ì›” ì„ íƒ ì™„ë£Œ: ${birthDate.month}`);
      }
      
      // ì¼ ë“œë¡­ë‹¤ìš´
      const dayDropdown = page.locator('select[name*="day"], select[id*="day"], .day-select, [data-testid*="day"]').first();
      if (await dayDropdown.count() > 0) {
        await dayDropdown.selectOption({ value: birthDate.day.toString() });
        console.log(`ì¼ ì„ íƒ ì™„ë£Œ: ${birthDate.day}`);
      }
      
      // 13ì„¸ ë¯¸ë§Œ ì—ëŸ¬ ë©”ì‹œì§€ í™•ì¸
      await page.waitForTimeout(2000);
      const ageError = page.locator('text=/13ì„¸ ë¯¸ë§Œ|under 13|age restriction|parental consent/i');
      if (await ageError.count() > 0) {
        console.log('âœ… 13ì„¸ ë¯¸ë§Œ ì œí•œ í™•ì¸ë¨');
      } else {
        console.log('âš ï¸ 13ì„¸ ë¯¸ë§Œ ì œí•œ ë©”ì‹œì§€ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ');
      }
      
    } catch (error) {
      console.log('ìƒë…„ì›”ì¼ ë“œë¡­ë‹¤ìš´ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜:', error.message);
    }
    
    console.log('âœ… 4ë‹¨ê³„ ì™„ë£Œ: ìƒë…„ì›”ì¼ ì…ë ¥ (13ì„¸ ë¯¸ë§Œ)');
  });
  
  test('5ë‹¨ê³„: ê³„ì • ìƒì„± í™•ì¸', async ({ page }) => {
    test.setTimeout(120000);
    
    console.log('âœ… 5ë‹¨ê³„: ê³„ì • ìƒì„± í™•ì¸ ì‹œì‘...');
    
    // í™ˆí˜ì´ì§€ ë°©ë¬¸ ë° íšŒì›ê°€ì… í˜ì´ì§€ë¡œ ì´ë™
    await page.goto('https://eterno-qa.ovdr.io');
    await page.waitForLoadState('networkidle');
    
    // ì¿ í‚¤ ë™ì˜
    try {
      const cookieAcceptButton = page.locator('button:has-text("Accept All")');
      if (await cookieAcceptButton.count() > 0) {
        await cookieAcceptButton.click();
        console.log('ğŸª ì¿ í‚¤ ë™ì˜ ì™„ë£Œ');
      }
    } catch (error) {
      console.log('ğŸª ì¿ í‚¤ ë™ì˜ ë²„íŠ¼ì´ ì—†ìŒ');
    }
    
    // Sign up ë²„íŠ¼ í´ë¦­
    const signUpButton = page.locator('a:has-text("Sign up")');
    await expect(signUpButton).toBeVisible({ timeout: 10000 });
    await signUpButton.click();
    await page.waitForLoadState('networkidle');
    await page.waitForTimeout(2000);
    
    // ê³„ì •ëª… ì…ë ¥
    const validAccountName = generateRandomAccountName();
    const usernameField = page.locator('input[type="text"], input[placeholder*="username"], input[placeholder*="account"], input[name*="username"]').first();
    await expect(usernameField).toBeVisible({ timeout: 10000 });
    await usernameField.fill(validAccountName);
    
    // 13ì„¸ ì´ìƒ ìƒë…„ì›”ì¼ ì…ë ¥
    const birthDate = generateBirthDate(false);
    
    try {
      const yearDropdown = page.locator('select[name*="year"], select[id*="year"], .year-select, [data-testid*="year"]').first();
      if (await yearDropdown.count() > 0) {
        await yearDropdown.selectOption({ value: birthDate.year.toString() });
      }
      
      const monthDropdown = page.locator('select[name*="month"], select[id*="month"], .month-select, [data-testid*="month"]').first();
      if (await monthDropdown.count() > 0) {
        await monthDropdown.selectOption({ value: birthDate.month.toString() });
      }
      
      const dayDropdown = page.locator('select[name*="day"], select[id*="day"], .day-select, [data-testid*="day"]').first();
      if (await dayDropdown.count() > 0) {
        await dayDropdown.selectOption({ value: birthDate.day.toString() });
      }
    } catch (error) {
      console.log('ìƒë…„ì›”ì¼ ì…ë ¥ ì¤‘ ì˜¤ë¥˜:', error.message);
    }
    
    // ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ (í•„ìš”í•œ ê²½ìš°)
    try {
      const passwordField = page.locator('input[type="password"], input[placeholder*="password"], input[name*="password"]').first();
      if (await passwordField.count() > 0) {
        await passwordField.fill('TestPassword123!');
        console.log('ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ ì™„ë£Œ');
      }
    } catch (error) {
      console.log('ë¹„ë°€ë²ˆí˜¸ í•„ë“œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ');
    }
    
    // íšŒì›ê°€ì… ë²„íŠ¼ í´ë¦­
    console.log('íšŒì›ê°€ì… ë²„íŠ¼ í´ë¦­...');
    const createAccountButton = page.locator('button:has-text("Create Account"), button:has-text("Sign Up"), button:has-text("Register"), button[type="submit"]').first();
    await expect(createAccountButton).toBeVisible({ timeout: 10000 });
    await createAccountButton.click();
    
    // ê³„ì • ìƒì„± ì™„ë£Œ ëŒ€ê¸°
    await page.waitForLoadState('networkidle');
    await page.waitForTimeout(3000);
    
    // ì„±ê³µ ë©”ì‹œì§€ ë˜ëŠ” ë¦¬ë‹¤ì´ë ‰íŠ¸ í™•ì¸
    const currentUrl = page.url();
    console.log('ê³„ì • ìƒì„± í›„ URL:', currentUrl);
    
    // ì„±ê³µ ë©”ì‹œì§€ í™•ì¸
    try {
      const successMessage = page.locator('text=/success|welcome|account created|íšŒì›ê°€ì… ì™„ë£Œ/i');
      if (await successMessage.count() > 0) {
        console.log('âœ… ê³„ì • ìƒì„± ì„±ê³µ ë©”ì‹œì§€ í™•ì¸ë¨');
      } else {
        console.log('âš ï¸ ì„±ê³µ ë©”ì‹œì§€ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ');
      }
    } catch (error) {
      console.log('ì„±ê³µ ë©”ì‹œì§€ í™•ì¸ ì¤‘ ì˜¤ë¥˜');
    }
    
    console.log('âœ… 5ë‹¨ê³„ ì™„ë£Œ: ê³„ì • ìƒì„± í™•ì¸');
  });
  
  test('6ë‹¨ê³„: ê³„ì • ì‚­ì œ', async ({ page }) => {
    test.setTimeout(120000);
    
    console.log('ğŸ—‘ï¸ 6ë‹¨ê³„: ê³„ì • ì‚­ì œ ì‹œì‘...');
    
    // ë¨¼ì € ë¡œê·¸ì¸
    await page.goto('https://eterno-qa.ovdr.io');
    await page.waitForLoadState('networkidle');
    
    // ì¿ í‚¤ ë™ì˜
    try {
      const cookieAcceptButton = page.locator('button:has-text("Accept All")');
      if (await cookieAcceptButton.count() > 0) {
        await cookieAcceptButton.click();
        console.log('ğŸª ì¿ í‚¤ ë™ì˜ ì™„ë£Œ');
      }
    } catch (error) {
      console.log('ğŸª ì¿ í‚¤ ë™ì˜ ë²„íŠ¼ì´ ì—†ìŒ');
    }
    
    // ë¡œê·¸ì¸
    await page.click('a:has-text("Sign in")');
    await page.click('button:has-text("[Dev] Bypass Sign in")');
    await page.fill('input[type="text"]', 'test111');
    await page.fill('input[type="password"]', 'test111');
    await page.click('button:has-text("Log in")');
    await page.waitForLoadState('networkidle');
    
    // ê³„ì • ì„¤ì • ë˜ëŠ” í”„ë¡œí•„ í˜ì´ì§€ë¡œ ì´ë™
    try {
      // í”„ë¡œí•„ ë˜ëŠ” ì„¤ì • ë©”ë‰´ ì°¾ê¸°
      const profileMenu = page.locator('a:has-text("Profile"), a:has-text("Settings"), a:has-text("Account"), button:has-text("Profile")').first();
      if (await profileMenu.count() > 0) {
        await profileMenu.click();
        await page.waitForLoadState('networkidle');
        console.log('í”„ë¡œí•„/ì„¤ì • í˜ì´ì§€ë¡œ ì´ë™');
      }
    } catch (error) {
      console.log('í”„ë¡œí•„ ë©”ë‰´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ');
    }
    
    // ê³„ì • ì‚­ì œ ë²„íŠ¼ ì°¾ê¸° ë° í´ë¦­
    try {
      const deleteAccountButton = page.locator('button:has-text("Delete Account"), button:has-text("ê³„ì • ì‚­ì œ"), a:has-text("Delete Account")').first();
      if (await deleteAccountButton.count() > 0) {
        await deleteAccountButton.click();
        console.log('ê³„ì • ì‚­ì œ ë²„íŠ¼ í´ë¦­');
        
        // í™•ì¸ ë‹¤ì´ì–¼ë¡œê·¸ ì²˜ë¦¬
        await page.waitForTimeout(2000);
        const confirmButton = page.locator('button:has-text("Confirm"), button:has-text("Delete"), button:has-text("Yes")').first();
        if (await confirmButton.count() > 0) {
          await confirmButton.click();
          console.log('ê³„ì • ì‚­ì œ í™•ì¸');
        }
        
        // ì‚­ì œ ì™„ë£Œ ëŒ€ê¸°
        await page.waitForLoadState('networkidle');
        await page.waitForTimeout(3000);
        
        console.log('âœ… ê³„ì • ì‚­ì œ ì™„ë£Œ');
      } else {
        console.log('âš ï¸ ê³„ì • ì‚­ì œ ë²„íŠ¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ');
      }
    } catch (error) {
      console.log('ê³„ì • ì‚­ì œ ì¤‘ ì˜¤ë¥˜:', error.message);
    }
    
    console.log('âœ… 6ë‹¨ê³„ ì™„ë£Œ: ê³„ì • ì‚­ì œ');
  });
});
